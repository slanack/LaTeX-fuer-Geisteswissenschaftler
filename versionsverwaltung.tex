% !TeX root = lfgw.tex
\chapter{Versionsverwaltung mit Subversion und Git}
\autor{Uwe Ziegenhagen}

Beim Arbeiten an längeren oder sehr wichtigen Dokumenten wie Bachelor-, Master- oder Doktorarbeiten ist es mehr als nur ratsam, sich um eine Strategie zur Sicherung der Daten kümmern. Dies gilt nicht nur für die Arbeit mit \LaTeX, sondern ganz allgemein. 

Einzelne Dateien oder ganze Festplatten/SSDs können kaputt gehen, Rechner gestohlen werden, zusammengefasst: externe Ereignisse können dazu führen, dass die Arbeit, in die man Wochen oder Monate gesteckt hat, nicht mehr verfügbar ist. 

Die Kosten für die professionelle Rettung von Daten von einer defekten Festplatte können leicht vierstellige Beträge erreichen, im Fall des Verlusts oder Diebstahls sind die Daten schlichtweg fort!

Die übliche Vorgehensweise, das Sichern von Dateien mit unterschiedlichen Zeitstempeln im Namen, ist besser als gar keine Sicherung zu haben, aber auch nicht unbedingt empfehlenswert. Sie schützt nur gegen Fehler, die man selbst im Dokument einbaut, nicht gegen Verlust oder technischen Defekt. Auch gegen einen Virus oder Verschlüsselungstrojaner, der alle Dateien auf dem Rechner löscht oder verschlüsselt und -- falls man Glück hat -- gegen anonyme Zahlung eines signifikanten Geldbetrages wieder entschlüsselt, hilft dies nicht.

In diesem Kapitel möchten wir verschiedene Möglichkeiten zeigen, wie man mit Hilfe eines Versionsverwaltungssystems Sicherungskopien seiner Arbeit verwalten kann.

\section{Grundlagen}

In der Softwareentwicklung setzt man seit Jahrzehnten auf die Nutzung von Versionsverwaltungssystem wie CVS/RSC, Subversion und Git, die -- neben dem Aspekt der Sicherungskopie außerhalb der eigenen vier Wände -- die Möglichkeit bieten, zu früheren Versionen einer Datei zurückzukehren. So könnte man beispielsweise zur letzten \TeX-Datei zurückgehen, die sich noch problemlos übersetzen ließ und diese mit der aktuellen, fehlerhaften Version vergleichen. Die meisten Betriebssysteme bringen zu diesem Zweck passende Werkzeuge mit, oftmals haben auch die Versionsverwaltungssysteme passendes an Bord.

In diesem Kapitel soll am Beispiel von Subversion und Git gezeigt werden, wie bei der Arbeit mit \TeX/\LaTeX\ Versionsverwaltungssysteme sinnvoll eingesetzt werden können.

Ein Hinweis noch: Die ordentliche Konfiguration einer Versionsverwaltung setzt ein gewisses technisches Verständnis voraus. Wer sich dies nicht zutraut, nutzt am besten einen der vielen Hoster, die die notwendige Infrastruktur und Expertise bereithalten. Github beispielsweise berechnet 7~US-\$ pro Monat für eine unbegrenzte Zahl privater (nicht öffentlich einsehbarer) Git-Repositories (die auch per Subversion-Client benutzt werden können), LCube-Hosting (\url{https://www.lcube-webhosting.de}) berechnet 2,99~Euro pro Monat für ein Gigabyte an Subversion-Repositories.

\section{Subversion}

Subversion wurde ursprünglich von CollabNet entwickelt, seit 2009 hat es seine Heimat bei der Apache Foundation gefunden. Es handelt sich bei Subversion um eine \textit{zentrale} Versionsverwaltung, das bedeutet das es einen zentralen Server gibt, auf dem der Subversion-Dienst läuft und auf den geänderte Dateien hochgeladen werden.

\subsection{Installation}

Es gibt verschiedene Möglichkeiten, einen Subversion-Server zu installieren. Die lokale Installation auf dem Arbeitsrechner ist nicht ohne weiteres empfehlenswert, denn im Fall des Verlusts geht nicht nur die lokale Kopie, sondern auch die komplette Versionshistorie verloren. Wenn man diesen Weg gehen möchte oder muss, dann sollte man sich auf jeden Fall um ein regelmäßiges, am besten automatisiertes, Backup auf einem externen Rechner -- am besten an einem anderen Standort -- kümmern. Ein Hinweis noch: es empfiehlt sich dringend, auch die Integrität des Backups gelegentlich zu prüfen. Ein kaputtes Backup bietet keinen Mehrwert!

Der Autor selbst hat gute Erfahrungen mit der Nutzung eines Synology NAS (NAS = \enquote{Network-Attached Storage}), also einer Netzwerkfestplatte gemacht, auf der der Subversion-Dienst mit wenigen Handgriffen installiert werden kann. Hier gilt zwar auch, dass eine externe Sicherung sehr ratsam ist, mit den bordeigenen Mitteln des NAS ist dies aber recht leicht umsetzbar. Persönlich nutzt der Autor dazu den täglichen Dump der letzten Version des Repositories in eine Datei, die dann verschlüsselt und gezippt bei einem Cloud-Anbieter gespeichert wird.

Eine weitere Möglichkeit bietet die Installation von beispielsweise \enquote{VisualSVN Server} (\url{https://www.visualsvn.com/server/}) für Windows, das in der Standard-Installation kostenlos verfügbar ist. Die Installation ist in wenigen Minuten erledigt, über spezielle Programme wird der Subversion-Dienst dann konfiguriert. Im folgenden gehen wir davon aus, das a) der Dienst auf dem lokalen Windows-Rechner läuft und b) ein leeres Repository \enquote{BachelorArbeit2017} eingerichtet wurde.

% https://desktop-tnm26jc/!/#BachelorArbeit2017

\subsection{Subversion von der Kommandozeile}

Subversion bringt einen eigenen Kommandozeilen-Client mit, der auf allen Betriebssystemen identisch funktioniert. Schon aus diesem Grund empfiehlt es sich, zumindest die Grundlagen dazu zu beherrschen.

Als erstes erfolgt der Checkout der Dateien aus dem Repository in ein leeres Verzeichnis. Dazu wechselt man auf die Kommandozeile (über die \enquote{Eingabeaufforderung}) und wechselt mittels \texttt{cd} in das Verzeichnis, in dem das Arbeitsverzeichnis erstellt werden soll. Dann gibt man den Befehl zum Checkout der Daten ein:

\texttt{svn checkout https://localhost/svn/BachelorArbeit2017/}

Nach der Eingabe von Benutzername und Passwort lädt Subversion dann die Dateien herunter, da aber unser Repository noch neu und damit leer war, erkennt man auf den Blick keinen Unterschied. 


\subsection{Grafische Clients}

Für die verschiedenen Betriebssysteme existieren auch diverse grafische Benutzeroberflächen für Subversion, Maß aller Dinge -- zumindest unserer Meinung nach -- ist dabei aber TortoiseSVN (\url{https://tortoisesvn.net/downloads.html}). Auf dieses hilfreiche Werkzeug möchten wir daher näher  eingehen.



\section{Integration von Subversion-Informationen in \LaTeX}

\subsection{svn-multi}


\section{Git}

Für dieses Buch wurde nicht Subversion, sondern git benutzt, das im Gegensatz zu Subversion nicht \textit{zentral}, sondern \textit{dezentral} arbeitet. Der Grund für git statt Subversion war dabei eher organisatorisch als technisch, mehrere der Co-Autoren hatten bereits gute Erfahrungen mit github.com gemacht, das -- wie der Name sagt -- git nutzt.

Im wesentlichen bedeutet \textit{dezentral}, dass es nicht einen zentralen Server gibt, der die Historie vorhält, sondern dass jeder Entwickler oder Autor die komplette Historie auf dem Rechner hat und Änderungen an den lokalen Dateien auch in das lokale git Repository eingecheckt werden. 

Man kann aber die lokalen Änderungen in ein entferntes (\enquote{remote}) Repository pushen, sodass es keine fundamentalen Unterschiede zur Arbeit mit git statt Subversion gibt.
Github unterstützt auch den Zugriff auf die Repositories über das Subversion-Protokoll, damit lassen sich auch grafische Clients wie TortoiseSVN mit github nutzen. 

Im folgenden soll gezeigt werden, wie man auf github ein neues Repository anlegt und damit Dateien verwaltet.




\endinput

Die aus Sicht des Autors beste Lösung ist daher eine Sicherung außerhalb des lokalen Rechners, idealerweise auch auf einem anderen Dateisystem. Der Grund hierfür ist technisch: Es sind Fälle bekannt, in denen Trojaner nicht nur die lokalen Dateien sondern auch alle Dateien auf angeschlossenen Netzlaufwerken verschlüsselten. Eine Sicherung auf einer Netzwerkfreigabe kann daher auch zu wenig sein. 



Und noch ein weiterer Aspekt soll genannt werden: die Arbeit mit mehreren Autoren und/oder auf mehreren Rechnern. Der Autor dieses Kapitels speichert wichtige Dokumente in einem Subversion-Repository. Soll mit einem anderem Rechner an den Dateien gearbeitet werden, so wird dort einfach ein neuer Checkout gemacht. Es darf nur am Ende der Arbeit nicht vergessen werden, die Dateien auch wieder mit dem Repository abzugleichen, dieser wichtige Schritt geht einem aber nach kurzer Zeit \enquote{in Fleisch und Blut} über.

Die Zusammenarbeit in einem Team vereinfacht sich drastisch, da der mühsame und fehlerträchtige Austausch von Dateien über FTP oder Email entfällt, ältere Versionen einer Datei können problemlos wiederhergestellt werden und die Zusammenführung verschiedener Versionen vereinfacht sich. Ein nicht zu unterschätzender Vorteil ist zudem die Möglichkeit, Backups quasi im \enquote{Vorbeigehen} zu erstellen.

