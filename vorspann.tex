% !TEX root = lfgw.tex
%\RequirePackage[ngerman=ngerman-x-latest]{hyphsubst} % Für LuaLaTeX auskommentieren.
\documentclass[%
ibycus,polutonikogreek,english,french,latin,ngerman,%global definiert!
   %%%draft=false,%
   fontsize=11pt,%
   paper=17cm:24cm,%
   DIV=13,%
   pagesize%
   ]{scrbook}

\usepackage{ifluatex}

\ifluatex
	\usepackage{luatex85}
	\usepackage{fontspec}
	\defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
	\usepackage{lfgwcjhebrew}
%	\newfontfamily\GFSDidot{GFS Didot}
	\newcommand\gkk[1]{%{\GFSDidot
	#1%}
	}
\else
	\usepackage[T1]{fontenc}
	\usepackage[utf8]{inputenc}
	\usepackage{cjhebrew}
	\newcommand{\gkk}[1]{\foreignlanguage{polutonikogreek}{#1}}
\fi

\usepackage[]{babel}
\usepackage{libertine}
%\RequirePackage{libertinegc}
\usepackage[supstfm=libertinesups,%
   supscaled=1.2,%
   raised=-.13em]% match XHeight of libertine
   {superiors}
\usepackage[scaled=0.8]{beramono}
%%%\usepackage{textcomp} %nicht notwendig, wenn man XeLaTeX oder LuaLateX nutzt
%\usepackage{euler}

\ifluatex
	\setmonofont[Scale=MatchLowercase,FakeStretch=0.85]{DejaVu Sans}%das wird für Griechisch in Codebeispielen gebraucht
\else
\fi

\usepackage{yfonts}
\usepackage{textgreek}
\usepackage[%
   final,%
   tracking=smallcaps,%
   %%%expansion=alltext,%
   protrusion=true%
   ]{microtype}%
\SetTracking{encoding=*,shape=sc}{50}%
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts

\usepackage[autostyle]{csquotes}
\usepackage[newcommands]{ragged2e}

\usepackage{graphicx}
\usepackage{grffile}
\usepackage[a4,center,cross]{crop}

\usepackage{listings}
\lstset{inputencoding=utf8,
  language=[LaTeX]{TeX},
  numbers=left, 
  %stepnumber=3, 
  numberfirstline=false,  
  numberstyle=\tiny\textsf,
  basicstyle=\footnotesize\ttfamily,
  %frame=tlrb,
  breaklines=true,
  %postbreak=\mbox{$\hookrightarrow$},
  escapeinside={{*@}{@*}},
  %showstringspace=false, 
  captionpos=b,
  literate={ä}{{\"a}}1{ö}{{\"o}}1{ü}{{\"u}}1{ß}{{\ss}}1
  }

  
\usepackage[%
  skins,%
  listings,%
  breakable,%
]{tcolorbox}
\tcbset{%
lfgwstyle/.style={%
    before skip=\baselineskip,
    boxrule=0pt,
    %bottomrule=2pt,
    %toprule=2pt,
    %colframe=black,
    colback=black!5,
    coltitle=white,
    bicolor,
    sharp corners,
    colbacklower=white,
    fonttitle=\sffamily\bfseries,
    breakable,
    %label=#1,
}}


\newtcblisting[auto counter,number within=chapter]{lfgwexample}[1]{%
    lfgwstyle,
    fontupper=\small\ttfamily,
    sidebyside,
    listing and text,
    title=Bsp. \thetcbcounter,
    #1,
%text and listing,
}

\newtcblisting[auto counter,number within=chapter]{lfgwcode}[1]{%
    fontupper=\small\ttfamily,
    lfgwstyle,
    listing only,
    title=Codebsp. \thetcbcounter,
    #1,
}

\newtcblisting[auto counter,number within=chapter]{lfgwprint}[1]{%
    fontupper=\small,
    lfgwstyle,
    text only,
    title=Bsp. \thetcbcounter,
    #1,
}


\usepackage{showexpl}

\usepackage[pagewise]{lineno}

\usepackage{sidenotes}

\usepackage{multicol}

\usepackage{forest}

\usepackage{covington}
%%%\renewcommand{\it}{}
%%%\renewcommand{\rm}{}

\usepackage[hang]{footmisc} %%%MS: Evtl. besser direkt \deffootnote

\usepackage{enumitem}			% for simple list modifications
\setlist{leftmargin=*,before=\setlength{\rightmargin}{\leftmargin}}

\usepackage{parallel}


\usepackage{runic}

\usepackage{hieroglf}

\usepackage[normalem]{ulem}
\usepackage{letterspace}

\usepackage[hyphens]{url}

\usepackage{hologo}

\usepackage{siunitx} %Supreme typesetting of units
\sisetup{%
    tight-spacing=true, %
    %math-rm=\mathsf, 
    %		text-rm=\sffamily,
    detect-all, %Zahlen werden in der aktuellen Schrift angezeigt
    detect-family,
    exponent-to-prefix  	= true,%
    round-mode          	= places,% 
    round-precision     	= 2,%
    group-minimum-digits 	= 4, % Für "Tausenderpunkt" --> 1.234 anstatt 1234
    group-separator			={.},% für "12.345" statt "12 345"
    %  scientific-notation = engineering, % Use multiples of 3 as exponent
    locale					=DE, % Typeset numbers and units the German way
    range-phrase 			={$\times$},%
    %		zero-decimal-to-integer,%aus "2.0" wird "2"
    range-units				=single,  % --> 2 x 2 m, - auskommentieren für 2 m x 2 m
    %%%---------
%    unit-color=myred,
}

\usepackage[german]{keystroke}% Computer-Tastatur-Tasten in Anweisungs-Texte zu setzen (z.B. \Shift, \Ctrl, \Spacebar).

\usepackage{imakeidx}
\indexsetup{level = \subsection*, toclevel = subsection, noclearpage, headers = {\indexname}{\indexname}}

\makeindex[                title = {Allgemeiner Index}]
\makeindex[name = pakete,  title = {Verzeichnis der Paketnamen}]

\usepackage[%
    style=authoryear,  
%  style=historische-zeitschrift, % das am liebsten - aber der geht (bei mir?) nicht!
%  style=archaeologie,
%  pageref=true,
	backend=biber
	]{biblatex}
\addbibresource{lfgw-bibliographie.bib}
\defbibheading{bibliography}{\chapter{#1}} %%%Besser bei \addchap bleiben

\usepackage{varioref}

\usepackage{hyperxmp}
\usepackage{hyperref}
\hypersetup{					% setup the hyperref-package options
	pdftitle={LaTeX für Geisteswissenschaftler},	% 	- title (PDF meta)
	pdfsubject={Handbuch},% 	- subject (PDF meta)
	pdfauthor={varia},	% 	- author (PDF meta)
	pdfauthortitle={},
	pdfcopyright={Copyright (c) \the\year\. All rights reserved.},
	pdfhighlight=/N,
	pdfdisplaydoctitle=true,
	pdfdate={\the\year-\the\month-\the\day}
	pdflang={de},
    pdfencoding=unicode,   % Sorgt für korrekte Umlaute in den pdf-Lesezeichen - thm
	pdfcaptionwriter={varia},
	pdfkeywords={{LaTeX}, {Geisteswissenschaften}},
%	pdfproducer={XeLaTeX},
	pdflicenseurl={http://creativecommons.org/licenses/by-nc-nd/4.0/},
	plainpages=false,			% 	- 
  colorlinks   = true, %Colours links instead of ugly boxes
  urlcolor     =  blue!50!black, %Colour for external hyperlinks
  linkcolor    = blue, %Colour of internal links
  citecolor   = green!50!black, %Colour of citations
  linktoc=page,
  	pdfborder={0 0 0},			% 	-
	breaklinks=true,			% 	- allow line break inside links
 %   bookmarks=true,
	bookmarksnumbered=true,		%
	bookmarksopenlevel=2,
	bookmarksopen=true,		%
    bookmarksdepth=3,
	final=true	% = true, nur bei web-Dokument!! (wichtig!!)
}
\usepackage{bookmark}%advanced bookmarks

\usepackage{fancyvrb}
\usepackage[%
  series={A,B,C},%nur die Apparate A B C aktivieren
  noend,%keine Endotenapparate
  noeledsec%keine eledsections et al.
  %noledgroup%keine ledgroups -- das muss hier auskommentiert werden, damit die minipages funktionieren!
]{reledmac}%
\usepackage{reledpar}

%
% Definition in vorspann.tex damit es in 
% paralleleTexte und kritischeApparate verfügbar ist.
%
% Solche Abkürzungen sind aber kein guter Stil und führen
% leicht zu Problemen, wie man im vorherigen Commit sehen kann.
%
\newcommand\reledmac{\mbox{\Package{reledmac}}\xspace}

\usepackage[
  sort,
  nameinlink
  ]{cleveref}%nach hyperref laden

\providecommand*{\prog}[1]{\texttt{#1}}
\let\Program\prog

\providecommand*{\paket}[1]{\textsf{#1}\index[pakete]{#1}}
\let\Package\paket%zwecks kompatibilität mit DTK

\providecommand*{\LaTeXTeX}{\hologo{(La)TeX}}
\providecommand*{\AmSLaTeX}{\hologo{AmSLaTeX}}
\providecommand*{\AmSTeX}{\hologo{AmSTeX}}
\providecommand*{\biber}{\hologo{biber}}
\providecommand*{\BibTeX}{\hologo{BibTeX}}
\providecommand*{\BibTeXacht}{\hologo{BibTeX8}}
\providecommand*{\ConTeXt}{\hologo{ConTeXt}}
\let\context\ConTeXt
\providecommand*{\emTeX}{\hologo{emTeX}}
\providecommand*{\eTeX}{\hologo{eTeX}}
\providecommand*{\ExTeX}{\hologo{ExTeX}}
\providecommand*{\HanTheThanh}{\hologo{HanTheThanh}}
\providecommand*{\iniTeX}{\hologo{iniTeX}}
\providecommand*{\KOMAScript}{\hologo{KOMAScript}}
\providecommand*{\LaTeX}{\hologo{LaTeX}}
\providecommand*{\LaTeXe}{\hologo{LaTeX2e}}
\providecommand*{\LaTeXIII}{\hologo{LaTeX3}}
\providecommand*{\LaTeXML}{\hologo{LaTeXML}}
\providecommand*{\LuaLaTeX}{\hologo{LuaLaTeX}}
\let\lualatex\LuaLaTeX
\providecommand*{\LuaTeX}{\hologo{LuaTeX}}
\let\luatex\LuaTeX
\providecommand*{\LyX}{\hologo{LyX}}
\providecommand*{\METAFONT}{\hologo{METAFONT}}
\let\MF\METAFONT
\providecommand*{\MetaFun}{\hologo{MetaFun}}
\providecommand*{\METAPOST}{\hologo{METAPOST}}
\providecommand*{\MetaPost}{\hologo{MetaPost}}
\let\MP\METAPOST
\providecommand*{\MiKTeX}{\hologo{MiKTeX}}
\providecommand*{\NTS}{\hologo{NTS}}
\providecommand*{\OzMF}{\hologo{OzMF}}
\providecommand*{\OzMP}{\hologo{OzMP}}
\providecommand*{\OzTeX}{\hologo{OzTeX}}
\providecommand*{\OzTtH}{\hologo{OzTth}}
\providecommand*{\PCTeX}{\hologo{PCTeX}}
\providecommand*{\pdfTeX}{\hologo{pdfTeX}}
\let\pdftex\pdfTeX
\providecommand*{\pdfLaTeX}{\hologo{pdfLaTeX}}
\let\pdflatex\pdfLaTeX
\providecommand*{\PiC}{\hologo{PiC}}
\providecommand*{\PiCTeX}{\hologo{PiCTeX}}
\providecommand*{\plainTeX}{\hologo{plainTeX}}
\providecommand*{\SageTeX}{\hologo{SageTeX}}
\providecommand*{\SLiTeX}{\hologo{SLiTeX}}
\providecommand*{\teTeX}{\hologo{teTeX}}
\providecommand*{\TeXivht}{\hologo{TeX4ht}}
\providecommand*{\TTH}{\hologo{TTH}}
\providecommand*{\virTeX}{\hologo{virTeX}}
\providecommand*{\VTeX}{\hologo{VTeX}}
\providecommand*{\XeLaTeX}{\hologo{XeLaTeX}}
\providecommand*{\XeTeX}{\hologo{XeTeX}}
%%
\newcommand\BibTool{\textsc{Bib\hskip-.1em
      T\hskip-.15emo\hskip-.05emo\hskip-.05eml}\xspace}
\providecommand*{\tikz}{\textsf{Ti\textit{k}Z}}
%\providecommand*{\pgf/tikz}{\textsf{pgf/Ti\textit{k}Z}}
\def\pgf/tikz{\textsf{pgf/Ti\textit{k}Z}}
\providecommand*{\ALEPH}{\ensuremath{\aleph}}
\let\TikZ\tikz

\providecommand\eV{e.V\kern-0.18em\@ifnextchar.{}{.}\kern0.18em}
\providecommand\dante{\mbox{DANTE~\eV}}
\providecommand\Dante{DANTE,
   Deutschsprachige Anwendervereinigung \TeX~\eV}
\providecommand\DTK{Die \TeX\-ni\-sche Ko\-m{\"o}\-die}
\providecommand\PS{Post\-Script}
\providecommand\TUG{\TeX{} Users Group}
\providecommand\TUGboat{\textsl{TUGboat}}
\let\DANTE\dantelogo
\providecommand*{\TeXLive}{\TeX{}Live}

\def\BibLaTeX{Bib\hologo{LaTeX}}
\let\biblatex\BibLaTeX
\providecommand*{\CTAN}{\texttt{CTAN}\xspace}

\makeatletter
\DeclareRobustCommand\cs[1]{\texttt{\char`\\#1}}
\DeclareRobustCommand\meta[1]{%
   \ensuremath\langle
   \ifmmode \expandafter \nfss@text \fi
   {%
      \meta@font@select
      \edef\meta@hyphen@restore
      {\hyphenchar\the\font\the\hyphenchar\font}%
      \hyphenchar\font\m@ne
      \language\l@nohyphenation
      #1\/%
      \meta@hyphen@restore
   }\ensuremath\rangle
}
\def\marg{\@ifstar{\@@marg}{\@marg}}
\providecommand\@marg[1]{%
   {\ttfamily\char`\{}\meta{#1}{\ttfamily\char`\}}}
\providecommand\@@marg[1]{%
   {\ttfamily\char`\{}{#1}{\ttfamily\char`\}}}
\def\oarg{\@ifstar{\@@oarg}{\@oarg}}
\providecommand\@oarg[1]{%
   {\ttfamily[}\meta{#1}{\ttfamily]}}
\providecommand\@@oarg[1]{%
   {\ttfamily[}{#1}{\ttfamily]}}
\providecommand\parg[1]{%
   {\ttfamily(}\meta{#1}{\ttfamily)}}
\def\meta@font@select{\itshape}
\makeatother
\setlength{\footnotemargin}{4mm}

\tolerance 1414
\hbadness 1414
\emergencystretch 1.5em
\hfuzz 0.3pt
\widowpenalty=10000
\displaywidowpenalty=10000
\clubpenalty=5000
\interfootnotelinepenalty=9999
\brokenpenalty=2000
\vfuzz \hfuzz
%%%\raggedbottom

%***********************
%für katalog.tex
\usepackage{framed}
\newenvironment{bsp}{\begin{framed}\begin{footnotesize}}%
{\end{footnotesize}\end{framed}}
\newcommand\catalogueentry[1]{%
\RaggedRight\begingroup
\setkeys{catalogue}{#1}%
\ifdef{\KVhouse}{\section{\KVhouse
			\ifdef{\KVlabel}{\label{\KVlabel}}{}}
			}{}%
\begin{labeling}{Beschreibung}
\ifdef{\KVdescription}{\item[Beschreibung] \KVdescription}{}%
\ifdef{\KVlocation}{\item[Verortung] \KVlocation}{}%
\ifdef{\KVinterior}{%
	\item[Ausstattung] \KVinterior %
	\ifboolexpr{bool{@KVinteriorM} or bool {@KVinteriorW} or bool {@KVinteriorS}}{%
	\begin{labeling}{Wandgemälde}
			\ifdef{\KVinteriorM}{\item[Mosaike:] \KVinteriorM}{}
			\ifdef{\KVinteriorW}{\item[Wandgemälde:] \KVinteriorW}{}
			\ifdef{\KVinteriorS}{\item[Statuen:] \KVinteriorS}{}
			\end{labeling}
		}{}}%
	{%
	\ifboolexpr{bool{@KVinteriorM} or bool {@KVinteriorW} or bool {@KVinteriorS}}{%
		\item[Ausstattung]%
	\begin{labeling}{Wandgemälde}	
				\ifdef{\KVinteriorM}{\item[Mosaike:] \KVinteriorM}{}
				\ifdef{\KVinteriorW}{\item[Wandgemälde:] \KVinteriorW}{}
				\ifdef{\KVinteriorS}{\item[Statuen:] \KVinteriorS}{}
			\end{labeling}
	}{}}%
\ifdef{\KVsize}{	\item[Größe] \SI{\KVsize}{\meter\squared}}{}%
\ifdef{\KVbackref}{\item[Erwähnungen]S.\ \KVbackref}{}%		oder \pno{}
\end{labeling}
\endgroup
}

\makeatletter
\newbool{@KVinteriorM}
\newbool{@KVinteriorW}
\newbool{@KVinteriorS}
\define@key{catalogue}{house}{\def\KVhouse{#1}}
\define@key{catalogue}{label}{\def\KVlabel{#1}}
\define@key{catalogue}{description}{\def\KVdescription{#1}}
\define@key{catalogue}{location}{\def\KVlocation{#1}}
\define@key{catalogue}{size}{\def\KVsize{#1}}
\define@key{catalogue}{interior}{\def\KVinterior{#1}}
\define@key{catalogue}{interiorM}{\def\KVinteriorM{#1}\booltrue{@KVinteriorM}}
\define@key{catalogue}{interiorW}{\def\KVinteriorW{#1}\booltrue{@KVinteriorW}}
\define@key{catalogue}{interiorS}{\def\KVinteriorS{#1}\booltrue{@KVinteriorS}}
\define@key{catalogue}{backref}{\def\KVbackref{#1}}
\makeatother

% Autorkennung:   Wie soll's aussehen?
\providecommand{\autor}[1]{\hfill\textbf{#1}}

\endinput